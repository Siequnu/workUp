
  {% extends "header.html" %}
  
  
  {% block app_content %}
<div class="container">
<br>
  {% if admin %}
  <div class="row">
       
        <div class="card bg-light mb-3" style="max-width: 40rem;">
  <div class="card-body">
        
        	<h1>Admin assignments view</h1>
         <hr>
         <a href="{{url_for('assignments.create_assignment')}}" <button class="btn btn-primary"><i class="fa fa-plus-circle"></i> Create assignment</button></a>
        </div>
    </div>
  <br />
   <div class="container">
     
     <br>
      <br>
      <div class="row">
        <div class="col-xs-12">
          <div class="table-responsive">
            <table summary="The following assignments have been made" class="table table-bordered table-hover">
        	  <thead>
              <tr>
              <th>ID</th>
              <th>Title</th>
              <th>Description</th>
        		  <th>Due</th>
        		  <th>Created</th>
        		  <th>For class</th>
        		  <th>Created</th>
            <th>Review</th>
        		  <th>Peer review form</th>
        		  <th>Actions</th>
            </tr>
          </thead>
		  <tbody>
			{% for assignment, user, turma in assignmentsArray %}
            <tr>
              <td>{{assignment.id}}</td>
              <td>{{assignment.title}}</td>
              <td>{{assignment.description}}</td>
			  <td>{{assignment.due_date}}</td>
			  <td>{{user.username}}</td>
              <td>{{turma.turma_label}}</td>
              <td>{{assignment.timestamp.strftime('%Y-%m-%d %H:%M')}}</td>
             
             
             {% if assignment.peer_review_necessary == True %}
               <td><button class="btn btn-sm btn-secondary"><i class="fa fa-check-circle"></i></button></td>
              {% else %}
               <td><button class="btn btn-sm btn-secondary"><i class="fa fa-times-circle"></i></button></td>
              {% endif %}
              
			  <td>{{assignment.peer_review_form}}</td>
			  <td>
      <p><a href="{{url_for('assignments.delete_assignment', assignment_id = assignment.id)}}" <button class="btn btn-sm btn-danger"><i class="fa fa-trash-alt"></i> Delete </button></a></p>
       <p><a href="{{url_for('assignments.view_assignment_details', assignment_id = assignment.id)}}" <button class="btn btn-sm btn-primary"><i class="fa fa-folder-open"></i> View uploads </button></a></p>
      
     </td>
            </tr>
           {% endfor %}
          </tbody>
          <tfoot>
            <tr>
            </tr>
          </tfoot>
        </table>
      </div><!--end of .table-responsive-->
    </div>
  </div>
</div>
   
   {% elif assignmentsArray %}
  
    <div class="row">
         <div class="col-md-3">
      			<h1>Assignments</h1>
    		</div>
     </div>
 
 <hr>          
  <br><br>
    {% for assignment in assignmentsArray %}
        <div class="card bg-light mb-3">
        <div class="card-body">
         
      <h5>{{assignment['title']}}</h5>
          <h6 class="card-title">Due {{assignment['humanized_due_date']}} ({{assignment['due_date']}})</h6>
          <p class="card-text">{{assignment['description']}}</p>
        </div>
        <div class="card-footer">
                 {% if assignment['submitted_filename'] %}                   
                        <a href="" <button class="btn btn-secondary btn-lg btn-sm disabled"><i class="fa fa-file-alt"></i> {{assignment['submitted_filename']}} </button></a>
                     
                     {% if assignment['peer_review_necessary'] == True %}                   
                     
                        {% if assignment['complete_peer_review_count'] == 0 %}
                           
                            <a href="{{url_for('files.download_file', assignment_id = assignment['id'])}}" class="btn btn-primary btn-sm" role="button" aria-disabled="true">Submit Review 1</a>
                               <a href="#" class="btn btn-default btn-sm disabled" role="button" disabled="true">Submit Review 2</a>
                     
                         {% elif assignment['complete_peer_review_count'] == 1 %}
                            <a href="{{url_for('assignments.view_peer_review', comment_id=assignment['completed_peer_review_objects'][0].id)}}" class="btn btn-success btn-sm" role="button" aria-disabled="true">View Review 1</a>
                           <a href="{{url_for('files.download_file', assignment_id = assignment['id'])}}" class="btn btn-primary btn-sm" role="button" aria-disabled="true">Submit Review 2</a>
                         {% elif assignment['complete_peer_review_count'] == 2 %}
                         <a href="{{url_for('assignments.view_peer_review', comment_id=assignment['completed_peer_review_objects'][0].id)}}" class="btn btn-success btn-sm" role="button" aria-disabled="true">View Review 1</a>
                         <a href="{{url_for('assignments.view_peer_review', comment_id=assignment['completed_peer_review_objects'][1].id)}}" class="btn btn-success btn-sm" role="button" aria-disabled="true">View Review 2</a>
                         {% endif %}
                     {% else %}
                      <a href="" class="btn btn-info btn-lg btn-sm disabled " role="button" aria-disabled="true">This assignment will not be peer-reviewed</a>
                     
                     {% endif %}
                {% else %}
                    {% if assignment['assignment_is_past_deadline'] %}
                      <a href="#" class="btn btn-danger btn-sm disabled" role="button" aria-disabled="true">Assignment overdue.</a>
                    {% else %}
                        <a href="{{url_for('files.upload_file', assignment_id = assignment['id'])}}" <button class="btn btn-sm btn-primary"><i class="fa fa-file-upload"></i> Upload your assignment </button></a>
                        
                    {% endif %}
              
            {% endif %}
      
          </div>
        </div>
        
        
      
        {% endfor %}
        
      
      {% else %}
      	You have no assignments at present.
    	{% endif %}
  </div>
{% endblock %}
